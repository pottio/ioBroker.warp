{
  "version": 3,
  "sources": ["../../src/warp/warp-service.ts"],
  "sourcesContent": ["import { isArray, isObject } from '../lib/tools';\r\nimport { WarpAdapter } from '../main';\r\nimport { ContextLogger } from './../lib/context-logger';\r\nimport { WarpApiParameter, WarpApiSection, WarpMessage } from './models';\r\nimport { WarpApiDefinitions } from './warp-api-definitions';\r\nimport { WarpClient } from './warp-client';\r\n\r\nexport class WarpService {\r\n    private readonly _objectInitPeriodInSeconds = 60;\r\n    private readonly _adapter: WarpAdapter;\r\n    private readonly _log: ContextLogger;\r\n    private readonly _subscribedIds: string[] = [];\r\n    private readonly _client: WarpClient;\r\n    private _apiDefinitions!: WarpApiDefinitions;\r\n    private _startInitTimestamp!: number;\r\n    private _objectsInitPeriodIsActive = true;\r\n\r\n    constructor(adapter: WarpAdapter) {\r\n        this._adapter = adapter;\r\n        this._log = new ContextLogger(adapter, WarpService.name)\r\n        this._client = new WarpClient(adapter);\r\n    }\r\n\r\n    public async initAsync(versionBeforeUpdate: string): Promise<void> {\r\n        this._log.info('Initializing');\r\n        try {\r\n            this._startInitTimestamp = Date.now();\r\n            await this._client.initAsync();\r\n\r\n            const metaInformation = await this._client.getMetaInformationForStartup();\r\n            if (!metaInformation) {\r\n                throw new Error('Unable to receive meta information from WARP. Please make sure firmware version >= 2.0.0 is installed on your WARP charger');\r\n            }\r\n            this._log.info(`Received information from ${metaInformation.displayType} (${metaInformation.name}) with firmware version ${metaInformation.firmwareVersion}`);\r\n\r\n            this._log.info(`Generate API definitions for product '${metaInformation.product}'`);\r\n            this._apiDefinitions = new WarpApiDefinitions(metaInformation.product);\r\n\r\n            await this.deleteObjectsRemovedFromDefinitionsAfterAdapterUpdateAsync(versionBeforeUpdate);\r\n            await this.initialCreateSectionsAndActionsAsync(metaInformation.product);\r\n\r\n            await this._client.connectAsync();\r\n            this._client.webSocketMessageEmitter.on('message', async (message: WarpMessage) => this.handleWarpMessageAsync(message));\r\n        } catch (e) {\r\n            this._log.error('Initializing failed', e)\r\n        }\r\n        this._log.info('Initialized');\r\n    }\r\n\r\n\r\n    public async terminateAsync(): Promise<void> {\r\n        this._log.info('Terminating');\r\n        for (const id of this._subscribedIds) {\r\n            this._log.debug(`Unsubscribe state changes '${id}'`);\r\n            await this._adapter.unsubscribeStatesAsync(id);\r\n        }\r\n        this._client.disconnect();\r\n        this._log.info('Terminated');\r\n    }\r\n\r\n    public async handleStateChangedAsync(id: string, state: ioBroker.State): Promise<void> {\r\n        if (state.ack === false) {\r\n            this._log.info(`Handle changed state by user with id '${id}' to value '${state.val}'`);\r\n            try {\r\n                const section = this._apiDefinitions.getSectionByIdForProduct(id);\r\n                const parameter = section?.parameters.find(param => id.endsWith(param.name));\r\n                if (section && parameter && parameter.hasAction()) {\r\n                    this._log.silly(`Definition for id: ${JSON.stringify(parameter)}`);\r\n                    const payload = await this.transformPayloadAsync(state, section, parameter);\r\n                    if (parameter.actionTopic) {\r\n                        await this._client.sendMessageAsync({ topic: parameter.actionTopic, payload }, parameter.actionMethod ?? 'PUT');\r\n                    } else {\r\n                        this._log.warn(`Invalid action definition. WARP will not be notified about changed state`);\r\n                    }\r\n                } else {\r\n                    this._log.warn(`No action definition found. WARP will not be notified about changed state`);\r\n                }\r\n            } catch (e) {\r\n                this._log.error(`Handling changed state by user failed`, e);\r\n            }\r\n        }\r\n    }\r\n\r\n    private async transformPayloadAsync(state: ioBroker.State, section: WarpApiSection, parameter: WarpApiParameter): Promise<any> {\r\n        return new Promise(async (resolve) => {\r\n            switch (parameter.actionType) {\r\n                case 'update-value':\r\n                    resolve(JSON.parse(parameter.actionPayloadTemplate?.replace('#', this.toValueForPayload(state))));\r\n                    break;\r\n                case 'send-command':\r\n                    resolve(parameter.actionPayloadTemplate ? JSON.parse(parameter.actionPayloadTemplate) : null);\r\n                    break;\r\n                case 'update-config':\r\n                    const payloadParameters = section.parameters.filter(param => param.actionTopic && param.actionTopic === parameter.actionTopic);\r\n                    let payload = `{`;\r\n                    for (const payloadParameter of payloadParameters) {\r\n                        if (payloadParameter.name === parameter.name) {\r\n                            payload += `\"${payloadParameter.name}\": ${this.toValueForPayload(state)},`;\r\n                        } else {\r\n                            const otherState = await this._adapter.getStateAsync(`${section.id}.${payloadParameter.name}`);\r\n                            if (otherState) {\r\n                                payload += `\"${payloadParameter.name}\": ${this.toValueForPayload(otherState)},`;\r\n                            }\r\n                        }\r\n                    }\r\n                    payload = payload.slice(0, -1);\r\n                    payload += '}';\r\n                    resolve(JSON.parse(payload));\r\n                    break;\r\n                case 'send-json':\r\n                    resolve(JSON.parse(`${state.val}`));\r\n                    break;\r\n                default:\r\n                    this._log.warn(`Api parameter action type '${parameter.actionType}' is unknown.`);\r\n                    resolve(undefined);\r\n            }\r\n        });\r\n    }\r\n\r\n    private toValueForPayload(state: ioBroker.State): string {\r\n        return typeof state.val === 'string' ? `\"${state.val}\"` : `${state.val}`;\r\n    }\r\n\r\n    private async handleWarpMessageAsync(message: WarpMessage): Promise<void> {\r\n        this._log.debug(`Process new message from WARP charger with topic '${message.topic}'`);\r\n\r\n        let section: WarpApiSection | undefined;\r\n        let parameters: WarpApiParameter[] = [];\r\n        if (this._objectsInitPeriodIsActive) {\r\n            section = this._apiDefinitions.getSectionByTopicForProduct(message.topic);\r\n            this._log.silly(`Definition for topic: ${section?.toString()}`);\r\n            parameters = section ? section.parameters : [];\r\n        }\r\n\r\n        for (const property in message.payload) {\r\n            if (this._objectsInitPeriodIsActive) {\r\n                const parameter = parameters.find(param => param.name === property);\r\n                if (section && parameter) {\r\n                    this._log.debug(`Object init period active. Create object for parameter '${parameter.name}' in section '${section.id}'`)\r\n                    await this.createObjectsForParameterAndSubscribeActionAsync(section, parameter);\r\n                }\r\n            }\r\n\r\n            const sectionId = this.getSectionId(message);\r\n            const state = message.payload[property];\r\n            const id = `${sectionId}.${property}`;\r\n\r\n            await this.setStateSafelyAsync(id, state);\r\n            await this.handleArrayStatesIfNeededAsync(state, id);\r\n        }\r\n\r\n        if (this._objectsInitPeriodIsActive && this._startInitTimestamp) {\r\n            const ms = Date.now() - this._startInitTimestamp;\r\n            const seconds = Math.floor(ms / 1000);\r\n            this._objectsInitPeriodIsActive = seconds < this._objectInitPeriodInSeconds;\r\n            if (!this._objectsInitPeriodIsActive) this._log.info(`Object init period ended`);\r\n        }\r\n    }\r\n\r\n    private async handleArrayStatesIfNeededAsync(state: any, id: string): Promise<void> {\r\n        if (this._adapter.config.listBreakdownEnabled && isArray(state)) {\r\n            const states = (<[]>state);\r\n            for (let index = 0; index < states.length; index++) {\r\n                await this.setStateSafelyAsync(`${id}.${index}`, states[index]);\r\n            }\r\n        }\r\n    }\r\n\r\n    private getSectionId = (message: WarpMessage): string => message.topic.replace(/\\//g, '.');\r\n\r\n    private async setStateSafelyAsync(id: string, state: any): Promise<void> {\r\n        this._log.silly(`Set state for id: ${id}. State: '${state}'`);\r\n        await this._adapter.setObjectNotExistsAsync(id, {\r\n            type: 'state',\r\n            common: { name: '', type: 'mixed', role: 'state', read: true, write: false },\r\n            native: {},\r\n        });\r\n        if (isObject(state) || isArray(state)) {\r\n            state = JSON.stringify(state);\r\n        }\r\n        await this._adapter.setStateAsync(id, state, true);\r\n    }\r\n\r\n    private async deleteObjectsRemovedFromDefinitionsAfterAdapterUpdateAsync(versionBeforeUpdate: string): Promise<void> {\r\n        this._log.info('Migrate objects if adapter version changed since last adapter start');\r\n        try {\r\n            const lastMigratedAdapterVersion = this.semVerToNumber(versionBeforeUpdate);\r\n            for (const migrationKey in this._apiDefinitions.deletedParameterIds) {\r\n                const migrationVersion = this.semVerToNumber(migrationKey);\r\n                if (lastMigratedAdapterVersion < migrationVersion) {\r\n                    this._log.info(`Need migrating to '${migrationKey}'. Adapter version at last start: '${versionBeforeUpdate}'`);\r\n                    for (const parameterId of this._apiDefinitions.deletedParameterIds[migrationKey]) {\r\n                        this._log.debug(`Migration to '${migrationKey}': Definition was removed for '${parameterId}'. Delete object`);\r\n                        await this._adapter.delObjectAsync(parameterId, { recursive: true });\r\n                    }\r\n                }\r\n            }\r\n        } catch (e) {\r\n            this._log.error('Migrate objects failed', e)\r\n        }\r\n    }\r\n\r\n    private semVerToNumber(version: string): number {\r\n        return +version.replace(/\\./g, '')\r\n    }\r\n\r\n    private async initialCreateSectionsAndActionsAsync(product: string): Promise<void> {\r\n        this._log.info(`Create if not exists or override all sections and actions for product '${product}'`);\r\n        try {\r\n            for (const section of this._apiDefinitions.getAllSectionsForProduct()) {\r\n                await this.createObjectsForSectionAsync(section);\r\n                for (const parameter of section.parameters) {\r\n                    if (parameter.isRelevantFor(product) && parameter.hasAction()) {\r\n                        await this.createObjectsForParameterAndSubscribeActionAsync(section, parameter);\r\n                    }\r\n                }\r\n            }\r\n        } catch (e) {\r\n            this._log.error('Creating or overriding sections and actions failed', e)\r\n        }\r\n    }\r\n\r\n    private async createObjectsForSectionAsync(section: WarpApiSection): Promise<void> {\r\n        if (!section.api.preventCreating) {\r\n            this._log.debug(`Create or override device '${section.api.id}'`);\r\n            await this._adapter.setObjectAsync(section.api.id, {\r\n                type: 'device',\r\n                common: { name: section.api.description },\r\n                native: {},\r\n            });\r\n        }\r\n        this._log.debug(`Create or override channel '${section.id}'`);\r\n        await this._adapter.setObjectAsync(section.id, {\r\n            type: 'channel',\r\n            common: { name: section.description },\r\n            native: {},\r\n        });\r\n    }\r\n\r\n    private async createObjectsForParameterAndSubscribeActionAsync(section: WarpApiSection, parameter: WarpApiParameter, sectionId?: string): Promise<void> {\r\n        const parameterId = `${sectionId ? sectionId : section.id}.${parameter.name}`;\r\n        const obj: ioBroker.SettableObject = { type: 'state', common: { name: parameter.description, role: '', read: parameter.read, write: parameter.hasAction() }, native: {} };\r\n        switch (parameter.type) {\r\n            case 'list':\r\n                obj.common.type = 'array';\r\n                obj.common.role = 'list';\r\n                break;\r\n            case 'enum':\r\n                obj.common.type = 'number';\r\n                obj.common.role = 'value';\r\n                obj.common.states = parameter.enumValues;\r\n                obj.common.unit = parameter.unit;\r\n                break;\r\n            case 'number':\r\n                obj.common.type = 'number';\r\n                obj.common.role = 'value';\r\n                obj.common.states = parameter.enumValues;\r\n                obj.common.unit = parameter.unit;\r\n                obj.common.min = parameter.min;\r\n                obj.common.max = parameter.max;\r\n                break;\r\n            case 'bool':\r\n                obj.common.type = 'boolean';\r\n                obj.common.role = 'indicator';\r\n                break;\r\n            case 'button':\r\n                obj.common.read = false;\r\n                obj.common.type = 'boolean';\r\n                obj.common.role = 'button';\r\n                if (parameter.buttonType === 'start') obj.common.role = 'button.start';\r\n                if (parameter.buttonType === 'stop') obj.common.role = 'button.stop';\r\n                break;\r\n            case 'json':\r\n                obj.common.type = 'object';\r\n                obj.common.role = 'state';\r\n                break;\r\n            case 'text':\r\n                obj.common.type = 'string';\r\n                obj.common.role = 'text';\r\n                break;\r\n            default:\r\n                this._log.warn(`Api definition type '${parameter.type}' is unknown.`);\r\n        }\r\n\r\n        this._log.debug(`Create or override state '${parameterId}'`);\r\n        await this._adapter.setObjectAsync(parameterId, obj);\r\n\r\n        if (parameter.hasAction()) {\r\n            this._log.debug(`Subscribe state changes '${parameterId}'`);\r\n            await this._adapter.subscribeStatesAsync(parameterId);\r\n            this._subscribedIds.push(parameterId);\r\n        }\r\n    }\r\n}\r\n\r\n"],
  "mappings": "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",
  "names": []
}
